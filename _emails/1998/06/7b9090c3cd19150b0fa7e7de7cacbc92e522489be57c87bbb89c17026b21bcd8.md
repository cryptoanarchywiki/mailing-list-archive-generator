---
layout: default
---

# 1998-06-02 - Re: Counterpane Cracks MS's PPTP

## Header Data

From: Brad Kemp \<kemp<span>@</span>indusriver.com\><br>
To: cypherpunks@toad.com<br>
Message Hash: 7b9090c3cd19150b0fa7e7de7cacbc92e522489be57c87bbb89c17026b21bcd8<br>
Message ID: \<3.0.3.32.19980602090947.0317cc10@pop3.indusriver.com\><br>
Reply To: \<Version.32.19980601122218.00fbc410@pop.pipeline.com\><br>
UTC Datetime: 1998-06-02 13:09:55 UTC<br>
Raw Date: Tue, 2 Jun 1998 06:09:55 -0700 (PDT)<br>

## Raw message

```
{% raw  %}From: Brad Kemp <kemp@indusriver.com>
Date: Tue, 2 Jun 1998 06:09:55 -0700 (PDT)
To: cypherpunks@toad.com
Subject: Re: Counterpane Cracks MS's PPTP
In-Reply-To: <Version.32.19980601122218.00fbc410@pop.pipeline.com>
Message-ID: <3.0.3.32.19980602090947.0317cc10@pop3.indusriver.com>
MIME-Version: 1.0
Content-Type: text/plain



This is a good paper. It covered almost all of the failures of MS PPTP.  
However, I think it missed a big one.
It is possible to recover all the clear text from a PPTP session,
even if most of the traffic is going in one direction only.
The failure is in MPPE.  When MPPE gets a sequenceing error, it
resets the key.  This causes the cipher stream to be reset.  It is
partially covered in section 5.4 .
Since RC4 is a stream cipher, it generates the same
cipher stream for a given key.  This cipher stream is XORed with the clear
text.
To recover the clear text, an attacker just needs to force a
resyncronization by
sending a packet that has a bogus coherency count.  
If the attacker captures the original stream and the resynchronized stream
a simple XOR of the two streams results in an XOR of the cleartext.
While compression does make it harder to determine what the cleartext is,
It is likely that a determined attacker can decrypt and decompress the
XORed result.  
Brad
Brad Kemp
Indus River Networks, Inc.                   BradKemp@indusriver.com
31 Nagog Park						 978-266-8122
Acton, MA 01720                              fax 978-266-8111




{% endraw %}
```

## Thread

+ Return to [June 1998](/archive/1998/06)

+ Return to "[Alan <alan<span>@</span>ctrl-alt-del.com>](/author/alan_alan_at_ctrlaltdel_com_)"
+ Return to "[Brad Kemp <kemp<span>@</span>indusriver.com>](/author/brad_kemp_kemp_at_indusriver_com_)"
+ Return to "[Chris Wedgwood <chris<span>@</span>cybernet.co.nz>](/author/chris_wedgwood_chris_at_cybernet_co_nz_)"
+ Return to "[Dark Knight <DarkKnight<span>@</span>Elitehackers.org>](/author/dark_knight_darkknight_at_elitehackers_org_)"
+ Return to "["Iain Collins" <icollins<span>@</span>scotland.net>](/author/iain_collins_icollins_at_scotland_net_)"
+ Return to "[Jim Tatz <jtatz<span>@</span>chemistry.ohio-state.edu>](/author/jim_tatz_jtatz_at_chemistry_ohiostate_edu_)"
+ Return to "[John Young <jya<span>@</span>pipeline.com>](/author/john_young_jya_at_pipeline_com_)"
+ Return to "["Paul H. Merrill" <paulmerrill<span>@</span>acm.org>](/author/paul_h_merrill_paulmerrill_at_acm_org_)"
+ Return to "[Ryan Anderson <ryan<span>@</span>michonline.com>](/author/ryan_anderson_ryan_at_michonline_com_)"
+ Return to "["William H. Geiger III" <whgiii<span>@</span>invweb.net>](/author/william_h_geiger_iii_whgiii_at_invweb_net_)"
+ Return to "[Xcott Craver <caj<span>@</span>math.niu.edu>](/author/xcott_craver_caj_at_math_niu_edu_)"

+ 1998-06-01 (Mon, 1 Jun 1998 10:33:08 -0700 (PDT)) - [Counterpane Cracks MS's PPTP](/archive/1998/06/8dfea3863d8b9eb2634c3f70cacbf912175806800ebacaf6cc6b92f3eb337d5c) - _John Young \<jya@pipeline.com\>_
  + 1998-06-01 (Mon, 1 Jun 1998 14:38:44 -0700 (PDT)) - [Re: Counterpane Cracks MS's PPTP](/archive/1998/06/c7fbe2ae716080013b553608fe3b7fd62f73b44bdc3c37af9e308b6bdfd98052) - _"William H. Geiger III" \<whgiii@invweb.net\>_
    + 1998-06-02 (Mon, 1 Jun 1998 17:42:49 -0700 (PDT)) - [Holy QPRNF, part II (Re: Counterpane Cracks MS's PPTP)](/archive/1998/06/46c9632fae87d24c2a61f53ce44de391c43f0c3f0564747ed0bb7b989a20bed8) - _Xcott Craver \<caj@math.niu.edu\>_
    + 1998-06-02 (Mon, 1 Jun 1998 22:23:25 -0700 (PDT)) - [Re: Counterpane Cracks MS's PPTP](/archive/1998/06/3fb8892c02be3785db24546fca38b85d764b1a56592b6c005bf7c780a0af5064) - _Alan \<alan@ctrl-alt-del.com\>_
    + 1998-06-02 (Tue, 2 Jun 1998 04:16:03 -0700 (PDT)) - [Re: Counterpane Cracks MS's PPTP](/archive/1998/06/4c20704b716b78307026584519bda6c5d8294eea6f455203ca25305c5e7d82dd) - _Chris Wedgwood \<chris@cybernet.co.nz\>_
  + 1998-06-02 (Mon, 1 Jun 1998 20:24:24 -0700 (PDT)) - [Re: Counterpane Cracks MS's PPTP](/archive/1998/06/02798876a649e2ca78e032a7bb6f74828a8b565adf4dca44abc4a4920d774504) - _Chris Wedgwood \<chris@cybernet.co.nz\>_
    + 1998-06-02 (Tue, 2 Jun 1998 08:20:43 -0700 (PDT)) - [RE: Counterpane Cracks MS's PPTP](/archive/1998/06/7bb8b931fd9d274997ee3029db10128d46c59b567d679ee807646ff3e023e8c4) - _"Iain Collins" \<icollins@scotland.net\>_
      + 1998-06-02 (Tue, 2 Jun 1998 09:37:48 -0700 (PDT)) - [Re: Counterpane Cracks MS's PPTP](/archive/1998/06/ce8855776dc4ed4d3050e4da86adb9028a82dbc1d621d1716992f06d3b9de243) - _"Paul H. Merrill" \<paulmerrill@acm.org\>_
      + 1998-06-02 (Tue, 2 Jun 1998 16:10:10 -0700 (PDT)) - [WinNT C2?](/archive/1998/06/b4aae538327eaaee6133d7b86888c0e97baf1a525e71bf56650b6cf3c07e2761) - _Jim Tatz \<jtatz@chemistry.ohio-state.edu\>_
        + 1998-06-02 (Tue, 2 Jun 1998 16:51:48 -0700 (PDT)) - [Re: WinNT C2?](/archive/1998/06/01039f97d1dea095dd9906418db9455324cfe9b9994f8f9fa94f7da2bd83d371) - _"William H. Geiger III" \<whgiii@invweb.net\>_
          + 1998-06-03 (Tue, 2 Jun 1998 17:14:27 -0700 (PDT)) - [Re: WinNT C2?](/archive/1998/06/5bc78094b3417b1cb23a4f5902b7d486f5f422163592799e659eeb3b9c2abbd2) - _Jim Tatz \<jtatz@chemistry.ohio-state.edu\>_
            + 1998-06-03 (Tue, 2 Jun 1998 18:22:02 -0700 (PDT)) - [Re: WinNT C2?](/archive/1998/06/fc1c95181d91740cc4581b7ab41449f6040496e757471fa26de84a1fb7a4b67f) - _"William H. Geiger III" \<whgiii@invweb.net\>_
          + 1998-06-03 (Tue, 2 Jun 1998 17:42:52 -0700 (PDT)) - [Re: WinNT C2?](/archive/1998/06/da556809892b807c5254ec44c8d100727f673ed4f6136ca761fdca9553d21952) - _Dark Knight \<DarkKnight@Elitehackers.org\>_
            + 1998-06-03 (Tue, 2 Jun 1998 18:46:20 -0700 (PDT)) - [Re: WinNT C2?](/archive/1998/06/d9eee1f29d2690e80e5324ca4099e49a255d6f081156fda33dc822b5682336de) - _"William H. Geiger III" \<whgiii@invweb.net\>_
              + 1998-06-03 (Tue, 2 Jun 1998 21:32:09 -0700 (PDT)) - [Re: WinNT C2?](/archive/1998/06/eea84ce31dd144efad69164bd36a7fc6aa1719e9f7f2887dca3f4a50931fa105) - _Dark Knight \<DarkKnight@Elitehackers.org\>_
        + 1998-06-02 (Tue, 2 Jun 1998 16:54:58 -0700 (PDT)) - [Re: WinNT C2?](/archive/1998/06/f2d6825dba42993e39f7fbff65acf3077c8a7ce84cd55f592d6b268262096dea) - _Ryan Anderson \<ryan@michonline.com\>_
  + 1998-06-02 (Tue, 2 Jun 1998 06:09:55 -0700 (PDT)) - Re: Counterpane Cracks MS's PPTP - _Brad Kemp \<kemp@indusriver.com\>_
    + 1998-06-02 (Tue, 2 Jun 1998 16:31:53 -0700 (PDT)) - [Re: Counterpane Cracks MS's PPTP](/archive/1998/06/69333a683d052206d34644b2a74756ecd5e3bfbd6c8ee2a6043ae4e387d9abeb) - _Xcott Craver \<caj@math.niu.edu\>_

